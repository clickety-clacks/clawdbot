---
name: clawline-device-management
description: Handle Clawline device registration alerts and manage the allowlist. When you receive 'New device pending approval' alerts, use this skill to approve or deny.
metadata: { "openclaw": { "skillKey": "clawline-device-management" } }
---

# Clawline Device Management

You are responsible for device registration approvals. When a new device wants to connect, you receive an alert.

## Alert Format

When a device requests pairing:
```
New device pending approval: {claimedName} ({platform})
```

Examples:
- `New device pending approval: flynn (iOS)`
- `New device pending approval: test agent (iOS)`
- `New device pending approval: New device (Unknown platform)`

Note: `claimedName` is user-provided (what they typed in the app), not verified identity.

## Response Workflow

1. Check pending devices
2. Decide: approve or deny (ask user if unsure who this is)
3. Edit the JSON file directly
4. Report what you did

## File Locations

All under `~/.openclaw/clawline/` (override with `clawline.statePath`):

| File | Purpose |
|------|---------|
| `pending.json` | Devices waiting for approval |
| `allowlist.json` | Approved devices |
| `denylist.json` | Blocked devices (auto-rejected) |

The provider watches these files — edits apply immediately, no restart needed.

## JSON Structure

### pending.json / allowlist.json
```json
{
  "version": 1,
  "entries": [
    {
      "deviceId": "A1B2C3...",
      "claimedName": "flynn",
      "deviceInfo": { "platform": "iOS", "model": "iPhone" },
      "userId": "flynn",
      "isAdmin": true,
      "createdAt": 1706000000000,
      "lastSeenAt": 1706000000000
    }
  ]
}
```

### denylist.json
```json
[
  { "deviceId": "X9Y8Z7...", "createdAt": 1706000000000 }
]
```

## Identity Fields

| Field | Description |
|-------|-------------|
| `deviceId` | Stable per device/app install (generated by app) |
| `claimedName` | User-provided label (display only, not verified) |
| `userId` | Server-assigned routing identity (authoritative) |
| `isAdmin` | Manual flag — grants access to main session (`agent:main:main`) |
| `lastSeenAt` | Timestamp of last connection (ms since epoch) |

## Operations

### List Pending
```bash
jq '.entries[] | {deviceId, claimedName, deviceInfo}' ~/.openclaw/clawline/pending.json
```

### List Registered
```bash
jq '.entries[] | {deviceId, userId, claimedName, isAdmin, lastSeenAt}' ~/.openclaw/clawline/allowlist.json
```

### Approve a Device
Move entry from pending.json to allowlist.json:
1. Copy the entry from pending.json
2. Add `userId` (typically normalize claimedName: lowercase, punctuation → underscore)
3. Set `isAdmin: false` (or true if this should be admin)
4. Add to allowlist.json entries
5. Remove from pending.json entries

### Deny a Device
1. Remove from pending.json
2. Optionally add deviceId to denylist.json to block future attempts

### Revoke a Device
Remove the entry from allowlist.json. Device will need to re-pair.

### Promote/Demote Admin
Edit allowlist.json, set `isAdmin: true` or `false` for the device.

### Re-pair a Device
1. Remove from allowlist.json
2. User initiates pairing from app
3. Approve the new pending request

## Admin Access

- `isAdmin: true` grants access to the main session (`agent:main:main`)
- Admin status must be set manually — not derived automatically
- Multiple devices can be admin
- First approved device is NOT auto-admin
